<!DOCTYPE html>
<html lang="ko" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}자동 투자 시스템{% endblock %} - InvestApp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {"50":"#eff6ff","100":"#dbeafe","200":"#bfdbfe","300":"#93c5fd","400":"#60a5fa","500":"#3b82f6","600":"#2563eb","700":"#1d4ed8","800":"#1e40af","900":"#1e3a8a","950":"#172554"}
                    }
                }
            }
        }
    </script>
    <style>
        /* 추가적인 커스텀 스타일 */
        .active-nav {
            background-color: #3b82f6; /* primary-500 */
            color: white;
        }
    </style>
    {% block head %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 font-sans antialiased">

    <div class="min-h-screen flex">
        <!-- 사이드바 네비게이션 -->
        <nav class="w-64 bg-white dark:bg-gray-800 shadow-md flex-shrink-0">
            <div class="p-4 text-2xl font-bold text-primary-500 dark:text-primary-400">
                <a href="{% url 'trading:dashboard' %}">InvestApp</a>
            </div>
            <ul>
                <li><a href="{% url 'trading:dashboard' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">대시보드</a></li>
                <li><a href="{% url 'trading:portfolio' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">포트폴리오</a></li>
                <li><a href="{% url 'trading:orders' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">주문 내역</a></li>
                <li><a href="{% url 'trading:strategy_settings' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">전략 설정</a></li>
                <li><a href="{% url 'trading:system_management' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">시스템 관리</a></li>
                <li><a href="{% url 'strategy_engine:backtest' %}" class="block px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-700">백테스트</a></li>
            </ul>
            <div class="absolute bottom-0 w-64 p-4">
                <button id="darkModeToggle" class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.121-3.536a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM10 16a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM3.05 4.54a1 1 0 00-1.414 1.414l.707.707a1 1 0 001.414-1.414l-.707-.707zM5.464 14.54l-.707.707a1 1 0 101.414 1.414l.707-.707a1 1 0 00-1.414-1.414zM14.54 5.464l.707-.707a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414z"></path></svg>
                    <span class="ml-2">모드 전환</span>
                </button>
            </div>
        </nav>

        <!-- 메인 컨텐츠 -->
        <main class="flex-1 p-6 sm:p-10">
            {% block content %}
            <!-- 페이지 별 컨텐츠가 여기에 들어옵니다. -->
            {% endblock %}
        </main>
    </div>

    <script>
        // 다크모드 토글 로직
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        // 초기 테마 설정
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
            document.documentElement.classList.add('dark');
        } else {
            themeToggleDarkIcon.classList.remove('hidden');
            document.documentElement.classList.remove('dark');
        }

        const themeToggleBtn = document.getElementById('darkModeToggle');

        themeToggleBtn.addEventListener('click', function() {
            // 아이콘 토글
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            // 로컬 스토리지 및 html 클래스 토글
            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });

        // 현재 URL에 따라 네비게이션 링크 활성화
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll('nav a');
        navLinks.forEach(link => {
            if (link.getAttribute('href') === currentPath) {
                link.classList.add('active-nav');
            }
        });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>